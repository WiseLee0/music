{"version":3,"sources":["webpack:///./src/components/music-list/index.vue?dd52","webpack:///./src/api/rank.js","webpack:///./src/components/top-list/index.vue?5634","webpack:///./src/components/top-list/index.vue?e069","webpack:///src/components/top-list/index.vue","webpack:///./src/components/top-list/index.vue?99ef","webpack:///./src/components/top-list/index.vue","webpack:///./src/components/music-list/index.vue?6a09","webpack:///src/components/music-list/index.vue","webpack:///./src/components/music-list/index.vue?1c04","webpack:///./src/components/music-list/index.vue"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_04d3fe18_scoped_true_lang_stylus_rel_stylesheet_2Fstylus___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_04d3fe18_scoped_true_lang_stylus_rel_stylesheet_2Fstylus___WEBPACK_IMPORTED_MODULE_0___default","n","d","__webpack_exports__","getRank","getMusicList","axios__WEBPACK_IMPORTED_MODULE_0__","axios__WEBPACK_IMPORTED_MODULE_0___default","common_js_jsonp__WEBPACK_IMPORTED_MODULE_1__","_config__WEBPACK_IMPORTED_MODULE_2__","url","baseUrl","axios","post","then","res","Promise","resolve","data","req_0","topid","Object","assign","commonParams","needNewCode","uin","tpl","page","type","platform","jsonp","options","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_abef41f8_scoped_true_lang_stylus_rel_stylesheet_2Fstylus___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_abef41f8_scoped_true_lang_stylus_rel_stylesheet_2Fstylus___WEBPACK_IMPORTED_MODULE_0___default","render","_vm","this","_h","$createElement","_c","_self","attrs","name","title","bgImage","songs","rank","staticRenderFns","top_listvue_type_script_lang_js_","computed","_objectSpread","topList","length","image","vuex_esm","created","_getMusicList","methods","_this","topId","code","_normalize","songlist","$router","push","list","ret","forEach","item","albummid","songid","song","components","MusicList","music_list","components_top_listvue_type_script_lang_js_","component","componentNormalizer","staticClass","on","click","back","domProps","innerHTML","_s","ref","style","directives","rawName","value","expression","random","_v","select","selectItem","refresh","core_esm","use","pull_up_esm","music_listvue_type_script_lang_js_","mixins","mixin","bscroll","minTranslateY","props","String","default","Array","Boolean","bgStyle","concat","mounted","_initScroll","$refs","top","clientHeight","scrollY","pullUpLoad","probeType","onScroll","pullingUpHandler","randomPlay","pos","layer","transform","y","zIndex","scale","blur","percent","Math","abs","min","height","paddingTop","filter","$emit","finishPullUp","index","selectPlay","handlePlayList","playlist","bottom","beforeDestroy","destroy","watch","setTimeout","SongList","song_list","Loading","loading","components_music_listvue_type_script_lang_js_"],"mappings":"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","file":"js/chunk-21e43db8.9e03b43f.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=04d3fe18&scoped=true&lang=stylus&rel=stylesheet%2Fstylus&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=04d3fe18&scoped=true&lang=stylus&rel=stylesheet%2Fstylus&\"","import axios from 'axios'\r\nimport jsonp from 'common/js/jsonp'\r\nimport {\r\n    commonParams,\r\n    options,\r\n    baseUrl\r\n} from './config'\r\nexport function getRank() {\r\n    const url = baseUrl + 'api/getRank'\r\n    return axios.post(url).then(res => {\r\n        return Promise.resolve(res.data.req_0)\r\n    })\r\n}\r\n\r\nexport function getMusicList(topid) {\r\n    const url = 'https://c.y.qq.com/v8/fcg-bin/fcg_v8_toplist_cp.fcg'\r\n    const data = Object.assign({}, commonParams, {\r\n        topid,\r\n        needNewCode: 1,\r\n        uin: 0,\r\n        tpl: 3,\r\n        page: 'detail',\r\n        type: 'top',\r\n        platform: 'h5'\r\n    })\r\n    return jsonp(url, data, options)\r\n}\r\n\r\n// 这两个都是最新的接口，但是要配合使用，比较麻烦\r\nexport function getRankSongs(topId) {\r\n    const url = baseUrl + 'api/getRankSongs'\r\n    const data = Object.assign({}, commonParams, {\r\n        '-': 'getUCGI33960706188873346',\r\n        loginUin: 0,\r\n        hostUin: 0,\r\n        platform: 'yqq.json',\r\n        needNewCode: 0,\r\n        data: {\r\n            \"detail\": {\r\n                \"module\": \"musicToplist.ToplistInfoServer\",\r\n                \"method\": \"GetDetail\",\r\n                \"param\": {\r\n                    \"topId\": topId,\r\n                    \"offset\": 0,\r\n                    \"num\": 50,\r\n                    \"period\": \"2019-08-26\"\r\n                }\r\n            },\r\n            \"comm\": {\r\n                \"ct\": 24,\r\n                \"cv\": 0\r\n            }\r\n        }\r\n    })\r\n    return axios.get(url, {\r\n        params: data\r\n    }).then(res => {\r\n        return Promise.resolve(res.data)\r\n    })\r\n}\r\n\r\nexport function getRankDetail(albummid) {\r\n    const url = baseUrl + 'api/getRankDetail'\r\n    const data = Object.assign({}, commonParams, {\r\n        ct: 24,\r\n        albummid: albummid,\r\n        loginUin: 0,\r\n        hostUin: 0,\r\n        platform: 'yqq.json',\r\n        needNewCode: 0\r\n    })\r\n\r\n    return axios.get(url, {\r\n        params: data\r\n    }).then(res => {\r\n        return Promise.resolve(res.data)\r\n    })\r\n}","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=abef41f8&scoped=true&lang=stylus&rel=stylesheet%2Fstylus&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=abef41f8&scoped=true&lang=stylus&rel=stylesheet%2Fstylus&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('transition',{attrs:{\"name\":\"slide\"}},[_c('music-list',{attrs:{\"title\":_vm.title,\"bgImage\":_vm.bgImage,\"songs\":_vm.songs,\"rank\":true}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <transition name=\"slide\">\r\n    <music-list :title=\"title\" :bgImage=\"bgImage\" :songs=\"songs\" :rank=\"true\"></music-list>\r\n  </transition>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from \"vuex\";\r\nimport MusicList from \"components/music-list/index\";\r\nimport { getMusicList } from \"api/rank\";\r\nimport { createSong } from \"common/js/song\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      songs: []\r\n    };\r\n  },\r\n  computed: {\r\n    title() {\r\n      return this.topList.title;\r\n    },\r\n    bgImage() {\r\n      if(this.songs.length){\r\n        return this.songs[0].image\r\n      }\r\n      return ''\r\n    },\r\n    ...mapGetters([\"topList\"])\r\n  },\r\n  created() {\r\n    this._getMusicList();\r\n  },\r\n  methods: {\r\n    _getMusicList() {\r\n      if (!this.topList.topId) {\r\n        this.$router.push(\"/rank\");\r\n        return;\r\n      }\r\n      getMusicList(this.topList.topId).then(res => {\r\n        if (res.code === 0) {\r\n          this.songs = this._normalize(res.songlist);\r\n        }\r\n      });\r\n    },\r\n    _normalize(list) {\r\n      let ret = [];\r\n      list.forEach(item => {\r\n        if (item.data.albummid && item.data.songid)\r\n          ret.push(createSong(item.data));\r\n      });\r\n      return ret;\r\n    }\r\n  },\r\n  components: {\r\n    MusicList\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"stylus\" rel=\"stylesheet/stylus\">\r\n.slide-enter-active, .slide-leave-active {\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.slide-enter, .slide-leave-to {\r\n  transform: translate3d(100%, 0, 0);\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=abef41f8&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=abef41f8&scoped=true&lang=stylus&rel=stylesheet%2Fstylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"abef41f8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"music-list\"},[_c('div',{staticClass:\"back\",on:{\"click\":_vm.back}},[_c('i',{staticClass:\"icon-back\"})]),_c('h1',{staticClass:\"title\",domProps:{\"innerHTML\":_vm._s(_vm.title)}}),_c('div',{ref:\"bgImage\",staticClass:\"bg-image\",style:(_vm.bgStyle)},[_c('div',{staticClass:\"play-wrapper\"},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.songs.length>0),expression:\"songs.length>0\"}],ref:\"playBtn\",staticClass:\"play\",on:{\"click\":_vm.random}},[_c('i',{staticClass:\"icon-play\"}),_c('span',{staticClass:\"text\"},[_vm._v(\"随机播放全部\")])])]),_c('div',{staticClass:\"filter\"})]),_c('div',{ref:\"layer\",staticClass:\"bg-layer\"}),_c('div',{ref:\"list\",staticClass:\"list\"},[_c('div',{staticClass:\"song-list-wrapper\"},[_c('song-list',{attrs:{\"songs\":_vm.songs,\"rank\":_vm.rank},on:{\"select\":_vm.selectItem}})],1),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.songs.length || _vm.refresh),expression:\"!songs.length || refresh\"}],staticClass:\"loading-container\"},[_c('loading')],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"music-list\">\r\n    <div class=\"back\" @click=\"back\">\r\n      <i class=\"icon-back\"></i>\r\n    </div>\r\n    <h1 class=\"title\" v-html=\"title\"></h1>\r\n    <div class=\"bg-image\" :style=\"bgStyle\" ref=\"bgImage\">\r\n      <div class=\"play-wrapper\">\r\n        <div class=\"play\" v-show=\"songs.length>0\" ref=\"playBtn\" @click=\"random\">\r\n          <i class=\"icon-play\"></i>\r\n          <span class=\"text\">随机播放全部</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"filter\"></div>\r\n    </div>\r\n    <div class=\"bg-layer\" ref=\"layer\"></div>\r\n    <div class=\"list\" ref=\"list\">\r\n      <div class=\"song-list-wrapper\">\r\n        <song-list :songs=\"songs\" @select=\"selectItem\" :rank=\"rank\"></song-list>\r\n      </div>\r\n      <div class=\"loading-container\" v-show=\"!songs.length || refresh\">\r\n        <loading></loading>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport SongList from \"base/song-list/index\";\r\nimport BScroll from \"@better-scroll/core\";\r\nimport Loading from \"base/loading/index\";\r\nimport PullUp from \"@better-scroll/pull-up\";\r\nimport { playlistMixin } from \"common/js/mixin\";\r\nimport { mapActions } from \"vuex\";\r\nBScroll.use(PullUp);\r\nexport default {\r\n  mixins: [playlistMixin],\r\n  data() {\r\n    return {\r\n      bscroll: null,\r\n      minTranslateY: 0\r\n    };\r\n  },\r\n  props: {\r\n    bgImage: {\r\n      type: String,\r\n      default: \"\"\r\n    },\r\n    songs: {\r\n      type: Array,\r\n      default: () => []\r\n    },\r\n    title: {\r\n      type: String,\r\n      default: \"\"\r\n    },\r\n    rank: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    refresh: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  computed: {\r\n    bgStyle() {\r\n      return `background-image:url(${this.bgImage})`;\r\n    }\r\n  },\r\n  mounted() {\r\n    this._initScroll();\r\n  },\r\n  methods: {\r\n    _initScroll() {\r\n      // 列表在图片下面\r\n      this.$refs.list.style.top = `${this.$refs.bgImage.clientHeight}px`;\r\n      // 确定推到最顶值\r\n      this.minTranslateY = -this.$refs.bgImage.clientHeight + 40;\r\n      // 初始化scroll组件 probeType实时监测\r\n      this.bscroll = new BScroll(this.$refs.list, {\r\n        scrollY: true,\r\n        click: true,\r\n        pullUpLoad: true,\r\n        probeType: 3\r\n      });\r\n      // 监听滚动事件\r\n      this.bscroll.on(\"scroll\", this.onScroll);\r\n      // 监听上拉事件\r\n      this.bscroll.on(\"pullingUp\", this.pullingUpHandler);\r\n    },\r\n    random() {\r\n      this.randomPlay({\r\n        list: this.songs\r\n      });\r\n    },\r\n    back() {\r\n      this.$router.back();\r\n    },\r\n    onScroll(pos) {\r\n      // 让列表跟随scroll一起动\r\n      this.$refs.layer.style.transform = `translate3d(0,${pos.y}px,0)`;\r\n      let zIndex = 0;\r\n      let scale = 1;\r\n      let blur = 0;\r\n      // 图片缩放、模糊比例\r\n      const percent = Math.abs(pos.y / this.$refs.bgImage.clientHeight);\r\n      if (pos.y > 0) {\r\n        zIndex = 10;\r\n        scale = 1 + percent;\r\n      } else {\r\n        blur = Math.min(10, percent * 7);\r\n      }\r\n      // scroll情况判定\r\n      if (pos.y > this.minTranslateY) {\r\n        this.$refs.bgImage.style.height = \"0px\";\r\n        this.$refs.bgImage.style.paddingTop = \"70%\";\r\n      } else {\r\n        this.$refs.bgImage.style.height = \"40px\";\r\n        this.$refs.bgImage.style.paddingTop = 0;\r\n        zIndex = 10;\r\n        blur = 5;\r\n      }\r\n      this.$refs.bgImage.style.zIndex = zIndex;\r\n      this.$refs.bgImage.style.transform = `scale(${scale})`;\r\n      this.$refs.bgImage.style.filter = `blur(${blur}px)`;\r\n    },\r\n    pullingUpHandler() {\r\n      // 防止快速刷新 不是最佳方案\r\n      if (!this.refresh) {\r\n        this.$emit(\"pullData\");\r\n        this.bscroll.finishPullUp();\r\n      }\r\n    },\r\n    // 子组件的派发事件\r\n    selectItem(song, index) {\r\n      this.selectPlay({\r\n        list: this.songs,\r\n        index: index\r\n      });\r\n    },\r\n    // mixin 处理 滚动刷新\r\n    handlePlayList(playlist) {\r\n      const bottom = playlist.length > 0 ? \"60px\" : \"\";\r\n      this.$refs.list.style.bottom = bottom;\r\n      if (this.bscroll) this.bscroll.refresh();\r\n    },\r\n    ...mapActions([\"selectPlay\", \"randomPlay\"])\r\n  },\r\n  // 销毁scroll\r\n  beforeDestroy() {\r\n    if (this.bscroll) this.bscroll.destroy();\r\n  },\r\n  watch: {\r\n    songs() {\r\n      setTimeout(() => {\r\n        this.bscroll.refresh();\r\n      }, 20);\r\n    }\r\n  },\r\n  components: {\r\n    SongList,\r\n    Loading\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"stylus\" rel=\"stylesheet/stylus\">\r\n@import '~common/stylus/variable';\r\n@import '~common/stylus/mixin';\r\n\r\n.music-list {\r\n  position: fixed;\r\n  z-index: 100;\r\n  top: 0;\r\n  left: 0;\r\n  bottom: 0;\r\n  right: 0;\r\n  background: $color-background;\r\n\r\n  .back {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 6px;\r\n    z-index: 50;\r\n\r\n    .icon-back {\r\n      display: block;\r\n      padding: 10px;\r\n      font-size: $font-size-large-x;\r\n      color: $color-theme;\r\n    }\r\n  }\r\n\r\n  .title {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 10%;\r\n    z-index: 40;\r\n    width: 80%;\r\n    no-wrap();\r\n    text-align: center;\r\n    line-height: 40px;\r\n    font-size: $font-size-large;\r\n    color: $color-text;\r\n  }\r\n\r\n  .bg-image {\r\n    position: relative;\r\n    width: 100%;\r\n    height: 0;\r\n    padding-top: 70%;\r\n    transform-origin: top;\r\n    background-size: cover;\r\n\r\n    .play-wrapper {\r\n      position: absolute;\r\n      bottom: 20px;\r\n      z-index: 50;\r\n      width: 100%;\r\n\r\n      .play {\r\n        box-sizing: border-box;\r\n        width: 135px;\r\n        padding: 7px 0;\r\n        margin: 0 auto;\r\n        text-align: center;\r\n        border: 1px solid $color-theme;\r\n        color: $color-theme;\r\n        border-radius: 100px;\r\n        font-size: 0;\r\n\r\n        .icon-play {\r\n          display: inline-block;\r\n          vertical-align: middle;\r\n          margin-right: 6px;\r\n          font-size: $font-size-medium-x;\r\n        }\r\n\r\n        .text {\r\n          display: inline-block;\r\n          vertical-align: middle;\r\n          font-size: $font-size-small;\r\n        }\r\n      }\r\n    }\r\n\r\n    .filter {\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n      background: rgba(7, 17, 27, 0.3);\r\n    }\r\n  }\r\n\r\n  .bg-layer {\r\n    position: relative;\r\n    height: 100%;\r\n    background: $color-background;\r\n  }\r\n\r\n  .list {\r\n    position: fixed;\r\n    top: 0;\r\n    bottom: 0;\r\n    width: 100%;\r\n    background: $color-background;\r\n\r\n    .song-list-wrapper {\r\n      padding: 20px 30px;\r\n    }\r\n\r\n    .loading-container {\r\n      position: absolute;\r\n      width: 100%;\r\n      top: 50%;\r\n      transform: translateY(-50%);\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=04d3fe18&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=04d3fe18&scoped=true&lang=stylus&rel=stylesheet%2Fstylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"04d3fe18\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}