{"version":3,"sources":["webpack:///./src/api/rank.js","webpack:///./src/components/rank/index.vue?6c6c","webpack:///src/components/rank/index.vue","webpack:///./src/components/rank/index.vue?04ce","webpack:///./src/components/rank/index.vue","webpack:///./src/components/rank/index.vue?f12a"],"names":["__webpack_require__","d","__webpack_exports__","getRank","getMusicList","axios__WEBPACK_IMPORTED_MODULE_0__","axios__WEBPACK_IMPORTED_MODULE_0___default","n","common_js_jsonp__WEBPACK_IMPORTED_MODULE_1__","_config__WEBPACK_IMPORTED_MODULE_2__","url","baseUrl","axios","post","then","res","Promise","resolve","data","req_0","topid","Object","assign","commonParams","needNewCode","uin","tpl","page","type","platform","jsonp","options","render","_vm","this","_h","$createElement","_c","_self","ref","staticClass","_l","item","key","id","on","click","$event","selectItem","directives","name","rawName","value","expression","attrs","width","height","song","index","_v","_s","title","singerName","topList","length","staticRenderFns","core_esm","use","scroll_bar_esm","rankvue_type_script_lang_js_","mixins","mixin","bscroll","created","_getRank","mounted","_this","setTimeout","_initBscroll","methods","_objectSpread","setTopList","$router","push","path","concat","topId","_this2","rank","code","_normalize","group","refresh","list","arr","forEach","element","toplist","$refs","scrollY","probeType","scrollbar","handlePlayList","playList","bottom","style","vuex_esm","components","Loading","loading","components_rankvue_type_script_lang_js_","component","componentNormalizer","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_d77998c0_scoped_true_lang_stylus_rel_stylesheet_2Fstylus___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_d77998c0_scoped_true_lang_stylus_rel_stylesheet_2Fstylus___WEBPACK_IMPORTED_MODULE_0___default"],"mappings":"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","file":"js/chunk-b42b0d34.ff09882a.js","sourcesContent":["import axios from 'axios'\r\nimport jsonp from 'common/js/jsonp'\r\nimport {\r\n    commonParams,\r\n    options,\r\n    baseUrl\r\n} from './config'\r\nexport function getRank() {\r\n    const url = baseUrl + 'api/getRank'\r\n    return axios.post(url).then(res => {\r\n        return Promise.resolve(res.data.req_0)\r\n    })\r\n}\r\n\r\nexport function getMusicList(topid) {\r\n    const url = 'https://c.y.qq.com/v8/fcg-bin/fcg_v8_toplist_cp.fcg'\r\n    const data = Object.assign({}, commonParams, {\r\n        topid,\r\n        needNewCode: 1,\r\n        uin: 0,\r\n        tpl: 3,\r\n        page: 'detail',\r\n        type: 'top',\r\n        platform: 'h5'\r\n    })\r\n    return jsonp(url, data, options)\r\n}\r\n\r\n// 这两个都是最新的接口，但是要配合使用，比较麻烦\r\nexport function getRankSongs(topId) {\r\n    const url = baseUrl + 'api/getRankSongs'\r\n    const data = Object.assign({}, commonParams, {\r\n        '-': 'getUCGI33960706188873346',\r\n        loginUin: 0,\r\n        hostUin: 0,\r\n        platform: 'yqq.json',\r\n        needNewCode: 0,\r\n        data: {\r\n            \"detail\": {\r\n                \"module\": \"musicToplist.ToplistInfoServer\",\r\n                \"method\": \"GetDetail\",\r\n                \"param\": {\r\n                    \"topId\": topId,\r\n                    \"offset\": 0,\r\n                    \"num\": 50,\r\n                    \"period\": \"2019-08-26\"\r\n                }\r\n            },\r\n            \"comm\": {\r\n                \"ct\": 24,\r\n                \"cv\": 0\r\n            }\r\n        }\r\n    })\r\n    return axios.get(url, {\r\n        params: data\r\n    }).then(res => {\r\n        return Promise.resolve(res.data)\r\n    })\r\n}\r\n\r\nexport function getRankDetail(albummid) {\r\n    const url = baseUrl + 'api/getRankDetail'\r\n    const data = Object.assign({}, commonParams, {\r\n        ct: 24,\r\n        albummid: albummid,\r\n        loginUin: 0,\r\n        hostUin: 0,\r\n        platform: 'yqq.json',\r\n        needNewCode: 0\r\n    })\r\n\r\n    return axios.get(url, {\r\n        params: data\r\n    }).then(res => {\r\n        return Promise.resolve(res.data)\r\n    })\r\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"rank\",staticClass:\"rank\"},[_c('div',{ref:\"toplist\",staticClass:\"toplist\"},[_c('ul',_vm._l((_vm.topList),function(item){return _c('li',{key:item.id,staticClass:\"item\",on:{\"click\":function($event){return _vm.selectItem(item)}}},[_c('div',{staticClass:\"icon\"},[_c('img',{directives:[{name:\"lazy\",rawName:\"v-lazy\",value:(item.frontPicUrl),expression:\"item.frontPicUrl\"}],attrs:{\"width\":\"100\",\"height\":\"100\"}})]),_c('ul',{staticClass:\"songlist\"},_vm._l((item.song),function(song,index){return _c('li',{key:song.id,staticClass:\"song\"},[_c('span',[_vm._v(_vm._s(index + 1))]),_c('span',[_vm._v(_vm._s(song.title)+\" - \"+_vm._s(song.singerName))])])}),0)])}),0),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.topList.length),expression:\"!topList.length\"}],staticClass:\"loading-container\"},[_c('loading')],1)]),_c('router-view')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"rank\" ref=\"rank\">\r\n    <div class=\"toplist\" ref=\"toplist\">\r\n      <ul>\r\n        <li class=\"item\" v-for=\"item in topList\" :key=\"item.id\" @click=\"selectItem(item)\">\r\n          <div class=\"icon\">\r\n            <img width=\"100\" height=\"100\" v-lazy=\"item.frontPicUrl\" />\r\n          </div>\r\n          <ul class=\"songlist\">\r\n            <li class=\"song\" v-for=\"(song,index) in item.song\" :key=\"song.id\">\r\n              <span>{{index + 1}}</span>\r\n              <span>{{song.title}} - {{song.singerName}}</span>\r\n            </li>\r\n          </ul>\r\n        </li>\r\n      </ul>\r\n      <div class=\"loading-container\" v-show=\"!topList.length\">\r\n        <loading></loading>\r\n      </div>\r\n    </div>\r\n    <router-view></router-view>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getRank } from \"api/rank\";\r\nimport { playlistMixin } from \"common/js/mixin\";\r\nimport BScroll from \"@better-scroll/core\";\r\nimport ScrollBar from \"@better-scroll/scroll-bar\";\r\nimport Loading from \"base/loading/index\";\r\nimport { mapMutations } from \"vuex\";\r\nBScroll.use(ScrollBar);\r\nexport default {\r\n  mixins: [playlistMixin],\r\n  data() {\r\n    return {\r\n      topList: [],\r\n      bscroll: null\r\n    };\r\n  },\r\n  created() {\r\n    this._getRank();\r\n  },\r\n  mounted() {\r\n    // 初始化滑动组件\r\n    setTimeout(() => {\r\n      this._initBscroll();\r\n    }, 20);\r\n  },\r\n  methods: {\r\n    // 点击排行榜事件\r\n    selectItem(item) {\r\n      this.setTopList(item)\r\n      this.$router.push({\r\n        path: `/rank/${item.topId}`\r\n      });\r\n    },\r\n    // 获取排行榜数据\r\n    _getRank() {\r\n      getRank().then(res => {\r\n        if (res.code === 0) {\r\n          this.topList = this._normalize(res.data.group);\r\n          setTimeout(() => {\r\n            this.bscroll.refresh();\r\n          }, 200);\r\n        }\r\n      });\r\n    },\r\n    // 标准化数据\r\n    _normalize(list) {\r\n      let arr = [];\r\n      list.forEach(element => {\r\n        const { toplist } = element;\r\n        arr = arr.concat(toplist);\r\n      });\r\n      return arr;\r\n    },\r\n    // 初始化滚动\r\n    _initBscroll() {\r\n      this.bscroll = new BScroll(this.$refs.toplist, {\r\n        scrollY: true,\r\n        probeType: 1,\r\n        scrollbar: true,\r\n        click: true\r\n      });\r\n    },\r\n    // mixin 事件处理\r\n    handlePlayList(playList) {\r\n      const bottom = playList.length > 0 ? \"60px\" : \"\";\r\n      this.$refs.rank.style.bottom = bottom;\r\n      if (this.bscroll) this.bscroll.refresh();\r\n    },\r\n    ...mapMutations({\r\n      setTopList: \"SET_TOPLIST\"\r\n    })\r\n  },\r\n  components: {\r\n    Loading\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"stylus\" rel=\"stylesheet/stylus\">\r\n@import '~common/stylus/variable';\r\n@import '~common/stylus/mixin';\r\n\r\n.rank {\r\n  position: fixed;\r\n  width: 100%;\r\n  top: 88px;\r\n  bottom: 0;\r\n\r\n  .toplist {\r\n    height: 100%;\r\n    overflow: hidden;\r\n\r\n    .item {\r\n      display: flex;\r\n      margin: 0 20px;\r\n      padding-top: 20px;\r\n      height: 100px;\r\n\r\n      &:last-child {\r\n        padding-bottom: 20px;\r\n      }\r\n\r\n      .icon {\r\n        flex: 0 0 100px;\r\n        width: 100px;\r\n        height: 100px;\r\n      }\r\n\r\n      .songlist {\r\n        flex: 1;\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: center;\r\n        padding: 0 20px;\r\n        height: 100px;\r\n        overflow: hidden;\r\n        background: $color-highlight-background;\r\n        color: $color-text-d;\r\n        font-size: $font-size-small;\r\n\r\n        .song {\r\n          no-wrap();\r\n          line-height: 26px;\r\n        }\r\n      }\r\n    }\r\n\r\n    .loading-container {\r\n      position: absolute;\r\n      width: 100%;\r\n      top: 50%;\r\n      transform: translateY(-50%);\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=d77998c0&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=d77998c0&scoped=true&lang=stylus&rel=stylesheet%2Fstylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d77998c0\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=d77998c0&scoped=true&lang=stylus&rel=stylesheet%2Fstylus&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=d77998c0&scoped=true&lang=stylus&rel=stylesheet%2Fstylus&\""],"sourceRoot":""}